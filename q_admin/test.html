
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>퀴즈 문제</title>
    <!-- 부트스트랩 CSS 로드 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="test.css">
</head>

<body>

<!-- 네비게이션 바 -->
<nav class="navbar navbar-expand-lg">
  <div class="container-fluid navbar-custom">
    <a class="navbar-brand" href="#">
      <img src="../image/logo.png" alt="Crime Scene 로고" class="navbar-logo">
      <span class="text-white">Crime Scene</span>
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
      <div class="navbar-nav ms-auto">
        <a class="nav-link active" aria-current="page" href="../main/main.html">Home</a>
        <a class="nav-link" href="../notice/notice.html">소통하기</a>
        <a class="nav-link" href="../mapmain/mapmain.html">지도보기</a>
        <a class="nav-link" href="../chart/chart.html">범죄통계표</a>
        <a class="nav-link" href="../machinlearning/machinlearning.html">범죄예측</a>
        <a class="nav-link" href="../search/search.html">경찰서찾기</a>
      </div>
    </div>
  </div>
</nav>

<!-- 커뮤니티 페이지 선택 -->
<div class="community-menu">
    <div class="container">
        <div class="row align-items-center justify-content-center">
            <div class="col-auto">
                <span class="community-page"><i class="fas fa-home"></i> community</span>
            </div>
            <div class="col-auto">
                <nav class="nav justify-content-center">
                  <a class="nav-link" href="../notice/notice.html">공지사항</a>
                    <a class="nav-link" href="../board/board.html">의견 게시판</a>
                    <a class="nav-link" href="../question/question.html">설문조사</a>
                    <a class="nav-link" href="../quiz/quiz.html">퀴즈</a>
                </nav>
            </div>
        </div>
    </div>
</div>

<!-- 퀴즈 페이지 -->
<header class="header">
    <div class="container-h">
        <h1>퀴즈풀기</h1>
        <p>퀴즈를 통해 범죄 예방 및 대처 알아보기!</p>
    </div>
</header>

<!-- 퀴즈 상자 -->
<div class="quiz-container" id="quiz-container">
  <!-- 퀴즈 내용이 동적으로 로드됩니다 -->
</div>

<!-- 푸터 -->
<footer>
  <p>경기도 용인시 처인구 용인대학로 134 | 민원전화 010-1234-5678</p>
  <p>© 2024 Crime Scene. All rights reserved.</p>
  <p>본 사이트는 졸업작품을 위해 임시적으로 개발된 사이트임을 알립니다.</p>
</footer>

<script type="module" src="test.js"></script> <!-- JavaScript 파일 링크 -->


<!-- 제이쿼리 로드 -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

<!-- 부트스트랩 JS 로드 -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

</body>
</html>



















// Firebase 초기화
const firebaseConfig = {
    apiKey: "AIzaSyD7g5DdSIGP7FB5Jjsejqjwd71HKjZK0XI",
    authDomain: "crime-scene-9a5f5.firebaseapp.com",
    projectId: "crime-scene-9a5f5",
    storageBucket: "crime-scene-9a5f5.appspot.com",
    messagingSenderId: "1056014636450",
    appId: "1:1056014636450:web:3ca8a4560bf0c135a7cefb"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);

// Initialize Firestore
const db = firebase.firestore();

// 페이징 처리를 위한 변수
const itemsPerPage = 10;
let currentPage = 1;
let totalItems = 0;
let totalPages = 0;
let lastVisible = null;
let searchMode = false;

// 경찰서 목록 불러오기
function loadPoliceStations(page, searchQuery = null) {
    const resultDiv = document.getElementById('result');
    const paginationDiv = document.getElementById('pagination');
    resultDiv.innerHTML = '';
    paginationDiv.innerHTML = '';

    let query = db.collection('police').orderBy('경찰서명').limit(itemsPerPage);

    if (searchQuery) {
        query = db.collection('police')
            .where('경찰서명', '>=', searchQuery)
            .where('경찰서명', '<=', searchQuery + '\uf8ff')
            .orderBy('경찰서명')
            .limit(itemsPerPage);
        searchMode = true;
    } else {
        searchMode = false;
    }

    if (page > 1 && lastVisible) {
        query = query.startAfter(lastVisible);
    }

    query.get().then(querySnapshot => {
        if (!querySnapshot.empty) {
            lastVisible = querySnapshot.docs[querySnapshot.docs.length - 1];
        }

        querySnapshot.forEach(doc => {
            const data = doc.data();
            const itemDiv = document.createElement('div');
            itemDiv.classList.add('police-item');
            itemDiv.innerHTML = `<h5>${data.경찰서명}</h5><p>${data.주소}</p>`;
            resultDiv.appendChild(itemDiv);
        });

        // 페이지네이션
        const startPage = Math.max(1, page - 2);
        const endPage = Math.min(totalPages, page + 2);

        if (page > 1) {
            const prevButton = document.createElement('button');
            prevButton.classList.add('btn', 'btn-secondary', 'mx-1');
            prevButton.innerText = '이전';
            prevButton.onclick = () => {
                currentPage--;
                loadPoliceStations(currentPage, searchQuery);
            };
            paginationDiv.appendChild(prevButton);
        }

        for (let i = startPage; i <= endPage; i++) {
            const pageButton = document.createElement('button');
            pageButton.classList.add('btn', 'btn-secondary', 'mx-1');
            pageButton.innerText = i;
            pageButton.onclick = () => {
                currentPage = i;
                loadPoliceStations(currentPage, searchQuery);
            };
            if (i === page) {
                pageButton.classList.add('active');
            }
            paginationDiv.appendChild(pageButton);
        }

        if (page < totalPages) {
            const nextButton = document.createElement('button');
            nextButton.classList.add('btn', 'btn-secondary', 'mx-1');
            nextButton.innerText = '다음';
            nextButton.onclick = () => {
                currentPage++;
                loadPoliceStations(currentPage, searchQuery);
            };
            paginationDiv.appendChild(nextButton);
        }
    })
    .catch(error => console.error('Error loading police stations:', error));
}

// 초기 로드 시 전체 경찰서 수 가져오기
db.collection('police').get().then(querySnapshot => {
    totalItems = querySnapshot.size;
    totalPages = Math.ceil(totalItems / itemsPerPage);
    loadPoliceStations(currentPage);
});


// 검색 함수
function searchPoliceStation() {
    const searchQuery = document.getElementById('search').value.trim();
    currentPage = 1; // 검색 시 첫 페이지로 설정
    if (searchQuery) {
        db.collection('police')
            .where('경찰서명', '>=', searchQuery)
            .where('경찰서명', '<=', searchQuery + '\uf8ff')
            .get()
            .then(querySnapshot => {
                totalItems = querySnapshot.size;
                totalPages = Math.ceil(totalItems / itemsPerPage);
                loadPoliceStations(currentPage, searchQuery);
            })
            .catch(error => console.error('Error searching police station:', error));
    } else {
        db.collection('police').get().then(querySnapshot => {
            totalItems = querySnapshot.size;
            totalPages = Math.ceil(totalItems / itemsPerPage);
            loadPoliceStations(currentPage);
        });
    }
}
